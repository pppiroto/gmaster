@model IEnumerable<Gmaster.Models.Columns>
@{
    ViewData["Title"] = "Records";
}
<script type="text/javascript" charset="utf-8">
    webix.ui({
        id: "root_layout",
        rows: [
            {
                view: "toolbar", id: "mybar", elements: [
                    { view: "button", value: "Btn1", width: 70, click: "btn1_click" },
                    { view: "button", value: "Btn2", width: 70, click: "btn2_click" },
                    { view: "button", value: "Btn3", width: 70, click: "btn3_click" },
                    { view: "button", value: "Clear Form", width: 85, click: '$$("tableform").clear()' }]
            },
            {
                cols: [
                    {
                        view: "form",
                        id: "columns_form",
                        width: 400,
                        elements: [
                            {
                                cols: [
                                    { view: "button", value: "Search", width: 70, click: "btnSearch_click" },
                                    { view: "button", value: "Clear", width: 70, click: "btnClear_click" },
                                ]
                            },
@foreach (var colmn in Model) {
    <text>
                            { view: "text", value: '', label: "@(colmn.remarks ?? colmn.colname)", name: "@(colmn.colname)" },
    </text>
}
                        ]
                    },
                    { view: "resizer" },
                    {
                        rows: [
                            {
                                view: "pager",
                                id: "records_pager",
                                template:" {common.first()} {common.prev()} {common.pages()} {common.next()} {common.last()}",
                                size: 50,
                                group: 5,
                            },
                            {
                                view: "datatable",
                                id: "record_table",
                                columns: [
@foreach (var colmn in Model) {
    <text>
                                    { id: "@(colmn.colname)", header: "@(colmn.remarks ?? colmn.colname)", css: "rank", adjust: true },
    </text>
}
                                ],
                                position: "flex",
                                select: true,
                                pager: "records_pager",
                            }

                        ]
                    }
                ]
            }
        ]
    });
    
    function btnSearch_click() {
        var forms = $$("columns_form").getValues();
        var url = "/api/Tables/@(ViewBag.Schema)/@(ViewBag.Table)";

        webix.ajax().post(url, forms, function(text, data, XmlHttpRequest){
            var table = $$("record_table");
            table.clearAll();
            table.parse(data.json().records);
        });
    }
    function btnClear_click() {


    }
    function btn1_click() {
    }
    function btn2_click() {
    }
    function btn3_click() {
    }
</script>